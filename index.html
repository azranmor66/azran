<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ETHSZD36Z6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-ETHSZD36Z6');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azran | הפועל על פי עזרן</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    
    <style>
        /* שחור בוהק ויוקרתי יותר */
        body {
            background-color: #0f0f0f;
            background-image: radial-gradient(circle at top right, rgba(230, 30, 42, 0.05) 0%, transparent 40%),
                              radial-gradient(circle at bottom left, rgba(230, 30, 42, 0.05) 0%, transparent 40%);
        }

        .bg-animate {
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* כרטיס מאמר מעוצב בסגנון עזרן */
        .blog-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .blog-card:hover {
            border-color: #e61e2a;
            background: rgba(230, 30, 42, 0.05);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="text-white font-sans min-h-screen flex flex-col items-center py-12 px-4">

    <div class="fixed inset-0 z-0 opacity-30 bg-gradient-to-br from-[#0f0f0f] via-[#1a0505] to-[#0f0f0f] bg-animate"></div>

    <div class="relative z-10 w-full max-w-md flex flex-col items-center gap-6 animate-fade-in">
        
        <div class="relative group">
            <div class="absolute -inset-1 bg-gradient-to-r from-red-600 to-red-900 rounded-full blur opacity-20 group-hover:opacity-60 transition duration-1000"></div>
            <img src="https://raw.githubusercontent.com/azranmor66/azran/main/assets/images/logo.png" 
                 alt="Azran Logo" 
                 class="relative w-32 h-32 rounded-full object-cover border-2 border-[#222] bg-black shadow-2xl">
        </div>

        <div class="text-center space-y-1 mb-2">
            <h1 class="text-3xl font-black tracking-tight">מור עזרן</h1>
            <p class="text-red-600 font-bold text-sm tracking-widest uppercase">הפועל על פי עזרן</p>
        </div>

        <div id="links-container" class="w-full space-y-4">
            </div>

        <div class="w-full mt-10 space-y-6">
            <div class="flex items-center gap-4">
                <div class="h-[1px] flex-1 bg-gradient-to-l from-transparent to-red-600/50"></div>
                <h2 class="text-lg font-bold tracking-widest uppercase text-gray-300">Deep Dives</h2>
                <div class="h-[1px] flex-1 bg-gradient-to-r from-transparent to-red-600/50"></div>
            </div>
            
            <div id="dynamic-blog-container" class="space-y-4">
                <p class="text-center text-gray-500 text-sm italic">טוען ניתוחים אחרונים...</p>
            </div>
        </div>

        <footer class="mt-12 text-gray-600 text-xs">
            © Azran.cc 2026
        </footer>

    </div>

    <script src="script.js?v=linktree"></script>
    
    <script>
        // ניהול Identity
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }

        // פונקציית טעינת הבלוג
        async function loadBlogPosts() {
            const container = document.getElementById('dynamic-blog-container');
            const repo = 'azranmor66/azran'; 
            
            try {
                const response = await fetch(`https://api.github.com/repos/${repo}/contents/_posts`);
                const files = await response.json();
                
                if (!Array.isArray(files)) throw new Error("No files found");
                
                container.innerHTML = ''; 

                // הצגת 2 המאמרים האחרונים בלבד כדי לשמור על דף קצר
                for (const file of files.reverse().slice(0, 2)) {
                    const contentResponse = await fetch(file.download_url);
                    const rawText = await contentResponse.text();
                    const parts = rawText.split('---');
                    if (parts.length < 3) continue;
                    
                    const metadata = jsyaml.load(parts[1]);
                    
                    const postHTML = `
                        <div class="blog-card rounded-2xl p-5 block">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-[10px] font-bold text-red-600 uppercase tracking-tighter">
                                    ${new Date(metadata.date).toLocaleDateString('he-IL')}
                                </span>
                            </div>
                            <h3 class="text-lg font-bold leading-tight mb-2">${metadata.title}</h3>
                            <p class="text-gray-400 text-sm font-light line-clamp-2">${metadata.summary || ''}</p>
                            <div class="mt-4 flex items-center text-red-500 text-xs font-bold gap-1">
                                קרא את הניתוח המלא 
                                <i data-lucide="arrow-left" class="w-3 h-3"></i>
                            </div>
                        </div>
                    `;
                    container.innerHTML += postHTML;
                }
                lucide.createIcons();
            } catch (e) {
                console.error(e);
                container.innerHTML = '<p class="text-center text-gray-600 text-sm italic">ניתוחים חדשים בדרך...</p>';
            }
        }

        loadBlogPosts();
    </script>
</body>
</html>
